var Publisher_Theme_Admin=function(g){"use strict";return{init:function(){this.blocks_switch(),this.mailchimp(),this.custom_width_field(),this.setup_override_listing_settings(),this.white_label(),this.setup_listing_settings_override_event()},mailchimp:function(){g(document).on("change",".widget-mailchimp-code-field textarea",function(e,t){var i=g(this).val().match(/action="([^"]*?)"/i);null!=i&&void 0!==i[1]&&g(this).closest(".widget-mailchimp-code-field").siblings(".widget-mailchimp-url-field").find("input").val(i[1])}),g(document).on("change",'.wpb_el_type_textarea_raw_html textarea[name="mailchimp-code"]',function(){var e=g(this).val().match(/action="([^"]*?)"/i);null!=e&&void 0!==e[1]&&g(this).closest(".wpb_el_type_textarea_raw_html").siblings('div[data-vc-shortcode-param-name="mailchimp-url"]').find('textarea[name="mailchimp-url"]').val(e[1])})},blocks_switch:function(){g(document).on("click",".blocks-field .blocks-switch span, .blocks-field .title",function(){var e=g(this),t=e.closest(".blocks-field").find(".blocks-switch"),i=t.find("input"),n=t.closest(".bf-section-container").find('.blocks-field[data-related-to="'+e.closest(".blocks-field").data("id")+'"]');t.hasClass("checked")?(t.removeClass("checked").addClass("unchecked"),i.attr("value",0).change(),n.addClass("disabled")):(t.removeClass("unchecked").addClass("checked"),i.attr("value",1).change(),n.removeClass("disabled"))}).on("click",".blocks-field .blocks-checkbox-label",function(){var e=g(this).siblings(".blocks-checkbox");e.hasClass("checked")?(e.removeClass("checked").addClass("unchecked"),e.attr("value",0).change()):(e.removeClass("unchecked").addClass("checked"),e.attr("value",1).change())})},custom_width_field:function(){var c=150,h=600,r=1e3,d=1640,m=10,u=4;function p(e){return e.element.closest(".resizable-width-container")}function o(e){var t=0;return e.each(function(){t+=g(this).data("width-prc")}),t}function b(e){var t=[e.element,e.element.next(".resizable-width-column")],i=p(e),n=g(".resizable-width-column",i),a=n;return t.forEach(function(e){n=n.not(e)}),[n,a.not(n)]}function f(e,t){var i=p(t),n=b(t),a=n[1],l=g("input.total-width",i).val(),s=l-Math.ceil(o(n[0])/100*l);a.length||(a=g(".resizable-width-column",i),s=l),a.filter(":not(:last)").each(function(e){var t=g(this),i=t.data("width-prc"),n=Math.ceil(i/100*l);t.data("width-px",n).find(".resizable-width-labels-px").text(n+"px"),n<=c&&t.resizable("option","minWidth",t.outerWidth()),s-=n}),a.filter(":last").data("width-px",s).find(".resizable-width-labels-px").text(s+"px")}function w(e){return e.data("columns")||2}g(".resizable-width-column").each(function(){var e=g(this),t=e.data("width-prc");t&&e.outerWidth(t+"%")}),g(".resizable-width-columns").each(function(){g(".resizable-width-column:not(:last)",this).resizable({handles:"e",minHeight:250,maxHeight:250,stop:function(e,t){var i=0,n=[];g(".resizable-width-column",t.element.parent()).each(function(){var e=g(this),t=e.outerWidth();i+=t,n.push([e,t])}).promise().done(function(){i/=100;for(var e=0;e<n.length;e++){n[e][0].width(n[e][1]/i+"%")}})},resize:function(e,t){!function(e){var i=p(e),t=b(e),n=g(".resizable-width-section",i).outerWidth(),a=t[1],l=100-o(t[0]);a.filter(":not(:last)").each(function(){var e=g(this),t=Math.ceil(100*e.outerWidth()/n);e.data("width-prc",t).find(".resizable-width-labels-percentage").text(t+"%"),g("input.col-"+e.data("index")+"-width",i).val(t),l-=t}),l=Math.abs(l);var s=a.filter(":last");s.data("width-prc",l).find(".resizable-width-labels-percentage").text(l+"%"),g("input.col-"+s.data("index")+"-width",i).val(l)}(t),f(0,t)},start:function(e,t){var i,n,a,l;!function(e){var t=p(e),i=g(".resizable-width-columns-wrapper",t),n=g("input.total-width",t).val(),a=Math.max(2,w(i)-1)*u,l=i.width(),s=Math.floor(c*l/n);e.originalElement.resizable("option","minWidth",s);var o=e.originalElement.next(".resizable-width-column").width()+e.originalElement.width()+a-s;e.originalElement.resizable("option","maxWidth",o)}(t),n=[(i=t).element,i.element.next(".resizable-width-column")],a=p(i),l=g(".resizable-width-column",a),n.forEach(function(e){l=l.not(e)}),l.each(function(){var e=g(this),t=e.outerWidth();e.outerWidth(t).css({"min-width":t,"max-width":t})}),n.forEach(function(e){e.attr("style","")})}})}),g(".resizable-width-container").each(function(){var e=g(this),t=e.find(".resizable-width-columns-wrapper"),i=w(t),l=(2==i?44:70)*i,s=2==i?h:r;function n(e){return(e-s)/(m/2)+l}var a=n(d),o=n(t.data("total"));g(".resizable-width-total-wrapper",e).width(o),t.width(o),t.resizable({minHeight:280,maxHeight:280,handles:"e,w",minWidth:l,maxWidth:a,resize:function(e,t){if(!(t.size.width%2)){var i,n=p(t),a=s+(t.size.width-l)/2*m;(i=a)%2&&i++,a=i,g(".resizable-width-total-wrapper",n).outerWidth(t.size.width).css("left",t.position.left),g(".resizable-width-total-number",n).text(Math.ceil(a)+"px"),g("input.total-width",n).val(a),f(0,t)}},start:function(e,t){t.element.find(".resizable-width-column").css({"min-width":"","max-width":""});var i=p(t);g(".resizable-width-column",i).each(function(){var e=g(this),t=e.find(".resizable-width-labels-percentage").text();e.outerWidth(t)})}}).data("resize-options",{maxWidth:a})})},setup_override_listing_settings:function(){var t,l=[".wpb_edit_form_elements",".kc-pop-tab"];t=[],l.forEach(function(e){t.push(e+" .advanced-block-settings :input")}),g(document).on("change",t.join(","),function(){var e="",t=g(this),i=t.closest(l.join(",")),n=g("input[name='override-listing-settings']",i).val(),a=g("input[name='listing-settings']",i);"0"!==n&&(e=t.closest(".advanced-block-settings").bf_serialize()),0===a.length?g("<input/>",{name:"listing-settings",class:"wpb_vc_param_value kc-param",value:e,type:"hidden"}).appendTo(i):a.val(e)}),t=[],l.forEach(function(e){t.push(e+' input[name="override-listing-settings"]')}),g(document).on("change",t.join(","),function(){if("0"===this.value){var e=g(this).closest(l.join(","));g("input[name='listing-settings']",e).remove()}})},setup_listing_settings_override_event:function(){g(document).ajaxSuccess(function(){var e=g(".wpb_edit_form_elements");g(".blocks-field :input:first",e).trigger("change")}),g(document).on("bf-kc-tab-loaded",function(e,t){g(".blocks-field :input:first",t).trigger("change")})},white_label:function(){if(!(g("#bf-panel.panel-publisher-white-label .bf-controls input[name=publisher]").length<=0)){var e="Publisher",t=g("li#toplevel_page_bs-product-pages-welcome > a .wp-menu-name"),i=t.find(".plugin-count"),n=g('li#toplevel_page_bs-product-pages-welcome li a[href="admin.php?page=better-studio/publisher"]'),a=g("li#wp-admin-bar-bs-product-pages-welcome-parent > a"),l=a.find(".plugin-count"),s=a.find(".bf-admin-bar-icon-bs-product-pages-welcome"),o=g('li#wp-admin-bar-bs-product-pages-welcome-parent li[id="wp-admin-bar-better-studio/publisher"] a');i=0<i.length?i[0].outerHTML:"",l=0<l.length?l[0].outerHTML:"",s=0<s.length?s[0].outerHTML:"";var c={"bs-icons":"bs-icons",fontawesome:"FontAwesome"};0<t.length&&g("#bf-panel.panel-publisher-white-label .bf-controls input[name=publisher]").on("keyup",function(){""===g(this).val()?(h(""),""!==l?t.html(e+' <span class="bs-admin-menu-badge">'+i+"</span>"):t.html(e)):(h("theme"),""!==l?t.html(g(this).val()+' <span class="bs-admin-menu-badge">'+i+"</span>"):t.html(g(this).val()))}),0<a.length&&g("#bf-panel.panel-publisher-white-label .bf-controls input[name=publisher]").on("keyup",function(){""===g(this).val()?""!==l?a.html(s+e+' <span class="bs-admin-menu-badge">'+l+"</span>"):a.html(s+e):""!==l?a.html(s+g(this).val()+' <span class="bs-admin-menu-badge">'+l+"</span>"):a.html(s+g(this).val())}),g("#bf-panel.panel-publisher-white-label .bf-section[data-id=theme_icon] .bf-controls input.icon-input").on("change",function(){""==g(this).siblings("input.icon-input-font-code").val()?g("<style>li#wp-admin-bar-bs-product-pages-welcome-parent .bf-admin-bar-icon-bs-product-pages-welcome:before,#adminmenu li#toplevel_page_bs-product-pages-welcome .wp-menu-image.wp-menu-image.wp-menu-image.wp-menu-image:before{ content: '\\b024' !important; font-family: '"+c["bs-icons"]+"'; }</style>").appendTo("head"):g("<style>li#wp-admin-bar-bs-product-pages-welcome-parent .bf-admin-bar-icon-bs-product-pages-welcome:before,#adminmenu li#toplevel_page_bs-product-pages-welcome .wp-menu-image.wp-menu-image.wp-menu-image.wp-menu-image:before{ content: '"+g(this).siblings("input.icon-input-font-code").val()+"' !important; font-family: '"+c[g(this).siblings("input.icon-input-type").val()]+"'; }</style>").appendTo("head")}),g("#bf-panel.panel-publisher-white-label .bf-controls input[name=white_label]").on("change",function(){var e=0==g("#bf-panel.panel-publisher-white-label .bf-controls input[name=white_label]").val()?"":"theme";"theme"==e&&""==g("#bf-panel.panel-publisher-white-label .bf-controls input[name=publisher]").val()&&(e=""),h(e)})}function h(e){var t;0<n.length&&((t=n.attr("href").split(/[\s/]+/))[1]=""==e?"publisher":e,n.attr("href",t.join("/")));0<o.length&&((t=o.attr("href").split(/[\s/]+/))[t.length-1]=""==e?"publisher":e,o.attr("href",t.join("/")))}}}}(jQuery);jQuery(document).ready(function(){Publisher_Theme_Admin.init()});