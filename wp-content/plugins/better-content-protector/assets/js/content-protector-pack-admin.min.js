!function(i){({setup:function(){var c=this;i(document).on("click",".cpp-watermark-control a",function(t){t.preventDefault();var a=i(this).closest("li"),e=a.hasClass("cpp-watermark-add")?"add":"remove",n=a.closest(".cpp-watermark-control"),o=wp.ajax.post("cpp-watermark",{status:e,post_id:n.data("post-id"),nonce:n.data("nonce")});c.block(n),o.done(function(){a.fadeOut(function(){a.siblings("li").fadeIn()});var t=a.closest(".media-modal-content");i(".attachment .thumbnail .centered img,.attachment-info .thumbnail img",t).each(function(){var t=i(this),a=t.attr("src"),e=a.toString().match(/(.+)\?\d+/);e&&e[1]&&(a=e[1]),t.attr("src",a+"?"+(new Date).getTime())})}),o.always(function(){c.unblock(n)})})},is_blocked:function(t){return!!t.data("bc-el-blocked")},block:function(t){this.is_blocked(t)||(t.data("bc-el-blocked",!0),t.prepend('<div class="bc-block-overlay" style="z-index:10;display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0;display:none;position: absolute;background:rgba(255,255,255,0.4)"></div>'),i(".bc-block-overlay").fadeIn())},unblock:function(t){this.is_blocked(t)&&(t.data("bc-el-blocked",!1),i(".bc-block-overlay").fadeOut(function(){i(this).remove()}))}}).setup()}(jQuery);